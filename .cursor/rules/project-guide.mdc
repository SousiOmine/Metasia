---
description: 
globs: 
alwaysApply: true
---
### プロジェクト名: Metasia

### 概要
Metasiaは、C#と.NET 8.0で開発されているマルチプラットフォーム対応の動画編集ソフトウェアです。UIフレームワークにAvalonia UIを採用しており、Windows, macOS, Linuxなど、さまざまなOSでの動作を目指しています。

---

### 技術スタック
* **言語**: `C#`
* **プラットフォーム**: `.NET 8.0`
* **UIフレームワーク**: `Avalonia UI`
* **グラフィックス**: `SkiaSharp` (2Dグラフィックス描画に使用)
---

### プロジェクト構造
このプロジェクトは、責務に応じて主に2つのプロジェクトに分割されています。

1.  **`Metasia.Core`**
    * 動画編集の核となるバックエンドロジックを担当します。
    * GUIフレームワークには依存せず、オブジェクトモデル、レンダリングパイプライン、ファイルI/O（JSONシリアライズ）、音声処理などの基本的な機能を含みます。
    * タイムライン (`TimelineObject`)、レイヤー (`LayerObject`)、各種メディアオブジェクト (`Text`など) の定義が含まれています。

2.  **`Metasia.Editor`**
    * `Avalonia UI`を使用して構築されたGUI部分（フロントエンド）です。
    * ユーザーインターフェースとユーザー操作の処理を担当します。
    * アーキテクチャとして**MVVM (Model-View-ViewModel)** パターンを採用しており、コードが以下の責務で分割されています。
        * **Views**: `.axaml`ファイルで定義されたUIの見た目。
        * **ViewModels**: UIの状態とロジックを管理。
        * **Models**: アプリケーションのデータ構造とビジネスロジック。
    * Undo/Redo機能 (`EditCommandManager`) や、プロジェクトファイルの管理 (`ProjectSaveLoadManager`) など、エディタ固有の機能もここに実装されています。

---

### 主な特徴
* **タイムラインベースの編集**: レイヤーとクリップを用いた直感的な編集が可能です。
* **プロパティアニメーション**: `Jint`ライブラリを利用し、オブジェクトの座標、拡大率、透明度などを時間経過で動的に変化させることができます。
* **JSONベースのプロジェクトファイル**: プロジェクトやタイムラインの状態は、人間が判読可能なJSON形式で保存されます。


* **コマンドパターンによる編集履歴**: Undo/Redo機能が実装されており、安全な編集が可能です。